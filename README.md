# solid_principles

## Нарушение принципов SOLID в numpy.ndarray 

### Почему он реализован так
Модуль numpy написан на С, большая часть представленного кода является простыми объявлениями. 
Реализован как "God Object", потому что:
 - Язык С не поддерживает ООП, следовательно архитектуру API, предоставляемую модулем numpy, и саму реализацию было бы проще поддерживать ориентируясь на архитектуру реализованную в С;
 - Создание отдельного объекта (например для сложения) создало бы оверхед по памяти и времени вычисления;
 - Какие-то иные причины для разработчиков.


### Конкретные примеры

В ходе анализа класса "ndarray" были выявлены следующие ключевые нарушения:

**S** В одном классе смешаны:
- Управление сырой памятью;
- Математическая логика;
- Манипуляции с формой;
- Ввод/вывод и форматирование.

**O** Класс не закрыт для модификации. Добавление новой математической операции требует изменения самого класса, а не подключения нового модуля.

**L** Т. к. у нас представлен всего один класс, то не нарушается.

**I**  Клиент, которому нужен массив просто как буфер данных, вынужден зависеть от математических методов которые ему не нужны.

**D** Высокоуровневые алгоритмы жестко связаны с конкретной реализацией хранения данных в памяти, что затрудняет перенос логики.

### Что было сделано

1. Разделили ответственности:
- Выделили математические операции в отдельный слой (MathEngine + MathOperation);
- Выделили хранение/представление данных в абстракцию ArrayData / MemoryLayout;
- Создали фасад NumpyArray, который в идеале должен только делегировать вызовы.

2. Сделали расширяемость операций:
- Добавили систему регистрации операций;
- Каждая операция (add, sub) - отдельный класс, реализующий узкий интерфейс;
- Добавление новой операции не требует изменения существующего кода - O.

3. Ввели абстракцию над данными:
- Перешли от прямой работы с np.ndarray к интерфейсу ArrayData;
- Добавили методы операций непосредственно в ArrayData;
- Операции теперь могут работать с абстракцией, а не с конкретной реализацией: сильный шаг к D и L.

### Что не соблюдено

1. D:
- Самое слабое место на данный момент;
- Почти весь код всё ещё от numpy.

2. S: 
- NumpyArray всё ещё многоответственный — он и фасад, и частично координатор, и знает про создание данных.

3. I:
- Пока ArrayData содержит всё подряд (доступ к элементам + математические операции);
- Это будет становиться всё более заметной проблемой по мере роста функциональности.